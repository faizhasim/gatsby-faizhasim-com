{"componentChunkName":"component---src-templates-post-template-tsx","path":"/posts/printing-a5-size-on-a4-papers-using-itext/","result":{"data":{"markdownRemark":{"id":"6cb58828-ca63-598e-9cb4-5a58cab71b57","html":"<p>My wife (edit in 2020: now ex-wife) asked me whether I can help her to print one of her ebook collections into A5 sized for better reading.\nWe have a normal A4 printer at home, and I’m planning to print 2 A5 pages into one page of A4 paper. We also want to remove the complexities of sorting the pages manually after printing (total pages are slightly less than 1000 pages).</p>\n<p>Cut to the chase, my rough idea is to:</p>\n<ul>\n<li>\n<p>Divide the PDF pages into half. First 500 pages (let’s called it head pages, for the sake of discussion) will be printed onto left hand side of the paper. The last 500 pages (also referred to as tail pages) will be printed onto right hand side of the paper.</p>\n</li>\n<li>\n<p>Since our printer does not support duplex printing, I need to print odds page first, then even pages. After doing some test prints, the position of the head pages switched with tail pages. Which means, for even pages, head pages on right hand side and tail pages on left hand side.</p>\n</li>\n</ul>\n<p>Everyone who knows OS X knows that <a href=\"http://en.wikipedia.org/wiki/Preview_(Mac_OS)\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Preview</a> is a really good app, in which functionality is quite close to Adobe Acrobat Professional with tighter integration to OS itself when modifying the PDF. Furthermore, <a href=\"http://en.wikipedia.org/wiki/Automator_(software)\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Automator</a> app is also bundle together to automate your workflow, including PDF manipulation. However, after spending 1/2 hour to determine whether these tools can help, I think I gave up on them. My need is more complex from what have been offered out-of-the-box.</p>\n<p>So, I quickly remembered iText library. And, I wrote a Java routine to basically convert the document. I think, no point explaining everything what the code does. Well, you can ask me if you want to know more and I’ll try to help out.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">pdfmagic</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">FileOutputStream</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">IOException</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>lowagie<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Document</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>lowagie<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DocumentException</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>lowagie<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Rectangle</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>lowagie<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span>pdf<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">PdfContentByte</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>lowagie<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span>pdf<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">PdfImportedPage</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>lowagie<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span>pdf<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">PdfReader</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>lowagie<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span>pdf<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">PdfWriter</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Interleave</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">DocumentException</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">PdfReader</span> pdfReader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PdfReader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/Users/mohdfaizhasim/Desktop/interleavepdf/all.pdf\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">PdfWriter</span> pdfWriterOdds <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">PdfWriter</span> pdfWriterEvens <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Document</span> documentOdds <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Document</span> documentEvens <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">int</span> totalCombinedPages <span class=\"token operator\">=</span> pdfReader<span class=\"token punctuation\">.</span><span class=\"token function\">getNumberOfPages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>pdfReader<span class=\"token punctuation\">.</span><span class=\"token function\">getNumberOfPages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"totalCombinedPages = \"</span> <span class=\"token operator\">+</span> totalCombinedPages<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">int</span> middlePage <span class=\"token operator\">=</span> totalCombinedPages <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">Rectangle</span> pageSize <span class=\"token operator\">=</span> pdfReader<span class=\"token punctuation\">.</span><span class=\"token function\">getPageSize</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">float</span> width <span class=\"token operator\">=</span> pageSize<span class=\"token punctuation\">.</span><span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">float</span> height <span class=\"token operator\">=</span> pageSize<span class=\"token punctuation\">.</span><span class=\"token function\">getHeight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">float</span> scaleFactor <span class=\"token operator\">=</span> width<span class=\"token operator\">/</span>height <span class=\"token operator\">+</span> <span class=\"token number\">0.04f</span><span class=\"token punctuation\">;</span>\n            documentOdds <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Document</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Rectangle</span><span class=\"token punctuation\">(</span>height<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pdfWriterOdds <span class=\"token operator\">=</span> <span class=\"token class-name\">PdfWriter</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span>documentOdds<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"combined-odds.pdf\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            documentOdds<span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">PdfContentByte</span> pdfContentByteOdds <span class=\"token operator\">=</span> pdfWriterOdds<span class=\"token punctuation\">.</span><span class=\"token function\">getDirectContent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> middlePage<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    documentOdds<span class=\"token punctuation\">.</span><span class=\"token function\">newPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token class-name\">PdfImportedPage</span> headPage <span class=\"token operator\">=</span> pdfWriterOdds<span class=\"token punctuation\">.</span><span class=\"token function\">getImportedPage</span><span class=\"token punctuation\">(</span>pdfReader<span class=\"token punctuation\">,</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    pdfContentByteOdds<span class=\"token punctuation\">.</span><span class=\"token function\">addTemplate</span><span class=\"token punctuation\">(</span>headPage<span class=\"token punctuation\">,</span> scaleFactor<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> scaleFactor<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19f</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">!=</span> middlePage <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">==</span> middlePage <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;&amp;</span> pdfReader<span class=\"token punctuation\">.</span><span class=\"token function\">getNumberOfPages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                        <span class=\"token class-name\">PdfImportedPage</span> tailPage <span class=\"token operator\">=</span> pdfWriterOdds<span class=\"token punctuation\">.</span><span class=\"token function\">getImportedPage</span><span class=\"token punctuation\">(</span>pdfReader<span class=\"token punctuation\">,</span> middlePage <span class=\"token operator\">+</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        pdfContentByteOdds<span class=\"token punctuation\">.</span><span class=\"token function\">addTemplate</span><span class=\"token punctuation\">(</span>tailPage<span class=\"token punctuation\">,</span> scaleFactor<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> scaleFactor<span class=\"token punctuation\">,</span> height <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n                documentEvens <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Document</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Rectangle</span><span class=\"token punctuation\">(</span>height<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                pdfWriterEvens <span class=\"token operator\">=</span> <span class=\"token class-name\">PdfWriter</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span>documentEvens<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"combined-evens.pdf\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                documentEvens<span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">PdfContentByte</span> pdfContentByteEvens <span class=\"token operator\">=</span> pdfWriterEvens<span class=\"token punctuation\">.</span><span class=\"token function\">getDirectContent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> middlePage<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                        documentEvens<span class=\"token punctuation\">.</span><span class=\"token function\">newPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token class-name\">PdfImportedPage</span> headPage <span class=\"token operator\">=</span> pdfWriterEvens<span class=\"token punctuation\">.</span><span class=\"token function\">getImportedPage</span><span class=\"token punctuation\">(</span>pdfReader<span class=\"token punctuation\">,</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        pdfContentByteEvens<span class=\"token punctuation\">.</span><span class=\"token function\">addTemplate</span><span class=\"token punctuation\">(</span>headPage<span class=\"token punctuation\">,</span> scaleFactor<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> scaleFactor<span class=\"token punctuation\">,</span> height <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">!=</span> middlePage <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">==</span> middlePage <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;&amp;</span> pdfReader<span class=\"token punctuation\">.</span><span class=\"token function\">getNumberOfPages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token class-name\">PdfImportedPage</span> tailPage <span class=\"token operator\">=</span> pdfWriterEvens<span class=\"token punctuation\">.</span><span class=\"token function\">getImportedPage</span><span class=\"token punctuation\">(</span>pdfReader<span class=\"token punctuation\">,</span> middlePage <span class=\"token operator\">+</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                            pdfContentByteEvens<span class=\"token punctuation\">.</span><span class=\"token function\">addTemplate</span><span class=\"token punctuation\">(</span>tailPage<span class=\"token punctuation\">,</span> scaleFactor<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> scaleFactor<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">19f</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token punctuation\">}</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>documentEvens <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    documentEvens<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pdfWriterEvens <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    pdfWriterEvens<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token class-name\">PdfReader</span> pdfReaderEven <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PdfReader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"combined-evens.pdf\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n                documentEvens <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Document</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Rectangle</span><span class=\"token punctuation\">(</span>height<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                pdfWriterEvens <span class=\"token operator\">=</span> <span class=\"token class-name\">PdfWriter</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span>documentEvens<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"combined-evens-reversed.pdf\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                documentEvens<span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">PdfContentByte</span> pdfContentByteEvens <span class=\"token operator\">=</span> pdfWriterEvens<span class=\"token punctuation\">.</span><span class=\"token function\">getDirectContent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> pdfReaderEven<span class=\"token punctuation\">.</span><span class=\"token function\">getNumberOfPages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    documentEvens<span class=\"token punctuation\">.</span><span class=\"token function\">newPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token class-name\">PdfImportedPage</span> headPage <span class=\"token operator\">=</span> pdfWriterEvens<span class=\"token punctuation\">.</span><span class=\"token function\">getImportedPage</span><span class=\"token punctuation\">(</span>pdfReaderEven<span class=\"token punctuation\">,</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    pdfContentByteEvens<span class=\"token punctuation\">.</span><span class=\"token function\">addTemplate</span><span class=\"token punctuation\">(</span>headPage<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>documentEvens <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    documentEvens<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pdfWriterEvens <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    pdfWriterEvens<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pdfReaderEven <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    pdfReaderEven<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>documentOdds <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                documentOdds<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pdfWriterOdds <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                pdfWriterOdds<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n            pdfReader<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Note: I’ve applied some PDF position and size adjustments directly in the code to maximise the font size.</p>","fields":{"slug":"/posts/2012-12-02---Printing-A5-size-on-A4-papers-using-iText.md//posts/printing-a5-size-on-a4-papers-using-itext","tagSlugs":["/tag/java/","/tag/itext/"]},"frontmatter":{"date":"2012-12-02T17:28:42","tags":["java","itext"],"title":"Printing A5 size on A4 papers using iText","description":"Automating bulk printing A4-sized papers into A5 size","socialImage":null}}},"pageContext":{"slug":"/posts/2012-12-02---Printing-A5-size-on-A4-papers-using-iText.md//posts/printing-a5-size-on-a4-papers-using-itext"}},"staticQueryHashes":["4208939363"],"slicesMap":{}}